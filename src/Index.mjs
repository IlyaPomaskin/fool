// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Game from "./fool/Game.mjs";
import * as Utils from "./Utils.mjs";
import * as React from "react";
import * as GameUI from "./components/GameUI.mjs";
import * as Server from "./Server.mjs";
import * as ClientUI from "./components/ClientUI.mjs";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as Belt_Result from "rescript/lib/es6/belt_Result.js";

function Index$Client(Props) {
  var game = Props.game;
  var match = React.useState(function () {
        return game;
      });
  var game$1 = match[0];
  var match$1 = React.useState(function () {
        
      });
  var handleMove = function (move) {
    
  };
  console.log("render", Game.toObject(game$1));
  return React.createElement("div", undefined, React.createElement(GameUI.InProgressUI.make, {
                  game: game$1
                }), React.createElement("div", {
                  className: "flex flex-wrap"
                }, Utils.uiList(game$1.players, (function (player) {
                        return React.createElement(ClientUI.make, {
                                    className: "m-1 flex-initial w-96",
                                    player: player,
                                    game: game$1,
                                    onMove: handleMove,
                                    key: player.id
                                  });
                      }))), React.createElement("div", undefined, Belt_Option.getWithDefault(Belt_Option.map(match$1[0], (function (err) {
                            return Utils.uiStr("Error: " + err);
                          })), Utils.uiStr("No errors"))));
}

function $$default(param) {
  var clientGame = param.clientGame;
  var authorGame = param.authorGame;
  var tmp;
  tmp = authorGame.TAG === /* Ok */0 ? React.createElement(Index$Client, {
          game: authorGame._0,
          player: Server.author
        }) : Utils.uiStr(authorGame._0);
  var tmp$1;
  tmp$1 = clientGame.TAG === /* Ok */0 ? React.createElement(Index$Client, {
          game: clientGame._0,
          player: Server.client
        }) : Utils.uiStr(clientGame._0);
  return React.createElement("div", undefined, React.createElement("div", {
                  className: "my-2 border rounded-md border-solid border-slate-500"
                }, tmp), React.createElement("div", {
                  className: "my-2 border rounded-md border-solid border-slate-500"
                }, tmp$1));
}

function getServerSideProps(_ctx) {
  return Promise.resolve({
              props: {
                authorGame: Belt_Result.map(Server.ProgressGameMap.get(Server.gamesInProgress, "GAME_ID"), (function (param) {
                        return Game.maskForPlayer(Server.author, param);
                      })),
                clientGame: Belt_Result.map(Server.ProgressGameMap.get(Server.gamesInProgress, "GAME_ID"), (function (param) {
                        return Game.maskForPlayer(Server.client, param);
                      }))
              }
            });
}

export {
  $$default ,
  $$default as default,
  getServerSideProps ,
  
}
/* react Not a pure module */
