// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Ws from "ws";
import * as $$WebSocket from "../bindings/WebSocket.mjs";
import * as WebSocketServer from "../bindings/WebSocketServer.mjs";

function $$default(param, res) {
  var wsServer = new Ws.WebSocketServer({
        backlog: 101,
        clientTracking: true,
        maxPayload: 104857600,
        noServer: false,
        path: "/ws",
        server: restartServer(),
        skipUTF8Validation: true
      });
  wsServer.addListener(WebSocketServer.Events.connection, (function (ws) {
          ws.on($$WebSocket.Events.message, (function (msg, isBinary) {
                  var $$this = this ;
                  console.log("THIS", $$this);
                  console.log("MSG", msg);
                  console.log("isBinary", isBinary);
                  var b = $$WebSocket.RawData.classify(msg);
                  if (typeof b === "number") {
                    console.log("unknown");
                    return ;
                  }
                  switch (b.TAG | 0) {
                    case /* Buffer */0 :
                        console.log("b", b._0);
                        return ;
                    case /* ArrayBuffer */1 :
                        console.log("ab", b._0);
                        return ;
                    case /* ArrayOfBuffers */2 :
                        console.log("aob", b._0);
                        return ;
                    
                  }
                }));
          
        }));
  res.end(Buffer.from("response"));
  
}

export {
  $$default ,
  $$default as default,
  
}
/* ws Not a pure module */
