// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Card from "./Card.mjs";
import * as Utils from "./Utils.mjs";
import * as Caml_obj from "rescript/lib/es6/caml_obj.js";
import * as Belt_List from "rescript/lib/es6/belt_List.js";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";

function isDefender(game, player) {
  return Caml_obj.caml_equal(game.defender, player);
}

function isAttacker(game, player) {
  return Caml_obj.caml_equal(game.attacker, player);
}

function isPlayerHasCard(player, card) {
  return Belt_List.has(player.cards, card, Utils.equals);
}

function isCorrectAdditionalCard(game, card) {
  return Belt_List.has(Card.getFlatTableCards(game.table), card, Card.isCardEqualsByRank);
}

function isFirstMove(game) {
  return Belt_List.length(game.table) === 0;
}

function toggleReady(game, player) {
  return {
          TAG: /* InLobby */0,
          _0: {
            players: Utils.toggleArrayItem(game.players, player),
            ready: game.ready
          }
        };
}

function lastListItem(list) {
  return Belt_List.get(list, Belt_List.size(list) - 1 | 0);
}

function getTrump(deck, players) {
  var lastCard = lastListItem(deck);
  var lastPlayer = lastListItem(Belt_List.keep(players, (function (p) {
              return Belt_List.length(p.cards) !== 0;
            })));
  if (lastCard !== undefined) {
    return lastCard[0];
  } else if (lastPlayer !== undefined) {
    return Belt_Option.map(lastListItem(lastPlayer.cards), (function (prim) {
                  return prim[0];
                }));
  } else {
    return ;
  }
}

export {
  isDefender ,
  isAttacker ,
  isPlayerHasCard ,
  isCorrectAdditionalCard ,
  isFirstMove ,
  toggleReady ,
  lastListItem ,
  getTrump ,
  
}
/* No side effect */
